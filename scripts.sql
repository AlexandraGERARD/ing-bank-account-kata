CREATE DATABASE "DB_BANK";

-- Création of the db_user datatable
CREATE TABLE public.db_user(
    user_id serial NOT NULL,
    login character varying(25) NOT NULL,
    password character varying(25) NOT NULL,
    PRIMARY KEY (id));

-- Data insertion into db_user
INSERT INTO db_user (login, password)
	VALUES
		('pdupont', 'pdupont'),
		('bmichel', 'bmichel'),
		('agerard', 'agerard'),
		('nmaurois', 'nmaurois'),
		('idupuis', 'idupuis'),
		('trenaud', 'trenaud'),
		('jtivolle', 'jtivolle');

-- Création of the db_account datatable
CREATE TABLE public.db_account(
    account_number character varying(34) NOT NULL,
    user_id integer NOT NULL,
    balance double precision NOT NULL DEFAULT 0.00,
    CONSTRAINT "PK_ACCOUNT" PRIMARY KEY (account_number),
    CONSTRAINT "FK_ACCOUNT_USER" FOREIGN KEY (user_id)
        REFERENCES public.db_user (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID);

    -- Data insertion into db_account
INSERT INTO db_account (user_id, account_number, balance)
VALUES 	(1, 'FR7630001007941234567890185', 2542.57),
		(1, 'FR7630004000031234567890143', 58724.25),
		(2, 'FR7630006000011234567890189', 201.24),
		(2, 'FR7610107001011234567890129', 14.37),
		(2, 'FR7611315000011234567890138', 2547.21),
		(3, 'FR7630002032531234567890168', 91547.24),
		(4, 'FR7630056009271234567890182', 214.31),
		(4, 'FR7611808009101234567890147', 1428.21),
		(5, 'FR7610011000201234567890188', 2147.01),
		(6, 'FR7630076020821234567890186', 753.14),
		(6, 'FR7614410000011234567890163', 3221.01),
		(6, 'FR7612548029981234567890161', 6.77),
		(7, 'FR7630007000111234567890144', 241.21),
		(7, 'FR7642559000011234567890121', 874.61),
		(7, 'FR7641199110541234567890180', 521.14);


-- Création of the db_transaction datatable
CREATE TABLE public.db_transaction(
    transaction_id serial NOT NULL,
    account_number character varying(34) NOT NULL,
    date date NOT NULL,
    amount double precision NOT NULL,
    PRIMARY KEY (transaction_id),
    CONSTRAINT "FK_TRANSACTION_ACCOUNT" FOREIGN KEY (account_number)
        REFERENCES public.db_account (account_number) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID);

-- Data insertion into db_transaction
INSERT INTO db_transaction (account_number, date, amount)
VALUES 	('FR7630001007941234567890185', '2020-06-01', 500),
		('FR7630001007941234567890185', '2020-05-16', -100),
		('FR7630001007941234567890185', '2020-01-01', 200),
		('FR7630001007941234567890185', '2019-11-14', 1942.57),
		('FR7630004000031234567890143', '2018-12-26', 500),
		('FR7630004000031234567890143', '2017-03-23', 1000),
		('FR7630004000031234567890143', '2016-03-07', -2000),
		('FR7630004000031234567890143', '2015-07-23', 100),
		('FR7630004000031234567890143', '2015-06-23', 100),
		('FR7630004000031234567890143', '2015-05-23', 100),
		('FR7630004000031234567890143', '2015-04-23', 100),
		('FR7630004000031234567890143', '2014-07-02', -200),
		('FR7630004000031234567890143', '2013-06-01', 59024.25),
		('FR7630006000011234567890189', '2020-03-15', -50),
		('FR7630006000011234567890189', '2020-01-15', -50),
		('FR7630006000011234567890189', '2019-12-15', -50),
		('FR7630006000011234567890189', '2019-11-15', -100),
		('FR7630006000011234567890189', '2019-10-15', -50),
		('FR7630006000011234567890189', '2019-09-15', -40),
		('FR7630006000011234567890189', '2019-08-15', -17),
		('FR7630006000011234567890189', '2019-07-15', -21),
		('FR7630006000011234567890189', '2019-06-15', -50),
		('FR7630006000011234567890189', '2019-05-15', -50),
		('FR7630006000011234567890189', '2019-04-15', -50),
		('FR7630006000011234567890189', '2019-03-15', -50),
		('FR7630006000011234567890189', '2019-02-15', 779.24),
		('FR7610107001011234567890129', '2020-01-07', 10),
		('FR7610107001011234567890129', '2020-01-06', -700),
		('FR7610107001011234567890129', '2020-01-05', -500),
		('FR7610107001011234567890129', '2020-01-04', 1204.37),
		('FR7611315000011234567890138', '2020-06-11', 2547.21),
		('FR7630002032531234567890168', '2020-03-24', -241.21),
		('FR7630002032531234567890168', '2020-02-12', -215.43),
		('FR7630002032531234567890168', '2020-01-04', 3.88),
		('FR7630002032531234567890168', '2019-12-26', 92000),
		('FR7630056009271234567890182', '2019-11-22', 25),
		('FR7630056009271234567890182', '2019-10-14', 54),
		('FR7630056009271234567890182', '2017-02-26', -235.31),
		('FR7630056009271234567890182', '2015-07-23', -62),
		('FR7630056009271234567890182', '2015-05-14', -14.57),
		('FR7630056009271234567890182', '2014-05-04', 447.19),
		('FR7611808009101234567890147', '2020-04-15', -26.31),
		('FR7611808009101234567890147', '2020-03-02', 200),
		('FR7611808009101234567890147', '2019-09-02', -200),
		('FR7611808009101234567890147', '2019-03-02', 200),
		('FR7611808009101234567890147', '2018-09-02', -200),
		('FR7611808009101234567890147', '2018-03-02', 1454.52),
		('FR7610011000201234567890188', '2019-09-20', -245.30),
		('FR7610011000201234567890188', '2018-09-21', -214.21),
		('FR7610011000201234567890188', '2017-09-22', 2606.52),
		('FR7630076020821234567890186', '2010-01-19', 753.14),
		('FR7614410000011234567890163', '2020-04-28', -245),
		('FR7614410000011234567890163', '2019-06-17', 214),
		('FR7614410000011234567890163', '2018-06-03', -75.2),
		('FR7614410000011234567890163', '2017-09-27', -100),
		('FR7614410000011234567890163', '2017-09-21', 3427.21),
		('FR7612548029981234567890161', '2020-06-01', -243.23),
		('FR7612548029981234567890161', '2020-05-15', -500),
		('FR7612548029981234567890161', '2020-05-01', 750),
		('FR7630007000111234567890144', '2018-08-13', 24),
		('FR7630007000111234567890144', '2018-07-28', -241),
		('FR7630007000111234567890144', '2017-07-21', 157.3),
		('FR7630007000111234567890144', '2017-02-05', -92.01),
		('FR7630007000111234567890144', '2016-06-04', 392.92),
		('FR7642559000011234567890121', '2019-11-23', -237.19),
		('FR7642559000011234567890121', '2019-10-14', -62),
		('FR7642559000011234567890121', '2017-09-02', 1173.8),
		('FR7641199110541234567890180', '2019-04-25', -632),
		('FR7641199110541234567890180', '2018-04-06', 23.54),
		('FR7641199110541234567890180', '2014-12-23', -420.32),
		('FR7641199110541234567890180', '2014-05-20', 1000),
		('FR7641199110541234567890180', '2013-05-07', -63),
		('FR7641199110541234567890180', '2012-03-19', 612.92);

COMMIT;
